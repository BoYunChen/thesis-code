function dy = HH2(t,y)
m = y(1);
n = y(2);
h = y(3);
Vm = y(4);

Vr = -71.4;
V = Vm - Vr;

a_m = 0.1*(V-25)/(1-exp((25-V)/10));
b_m = 4*exp((-V)/18);
a_h = 0.07*exp((-V)/20);
b_h = 1/(1+exp((30-V)/10));
a_n = 0.01*(V-10)/(1-exp(-(V-10)/10));
b_n = 0.125*exp((-V)/80);
    
m_t = a_m*(1-m) - b_m*m;
n_t = a_n*(1-n) - b_n*n;
h_t = a_h*(1-h) - b_h*h;
%--------------------------------------------------
    E1 = 50.0641;%51.0984;
    E2 = -82.1698;%-82.9527;
    
    g11 = 120;
    g12 = 0.0666;
    g1 = g11*m*m*m*h + g12;
    g21 = 36;
    g22 = 0.4334;
    g2 = g21*n^4 + g22;
    
    C1 = g1*(Vm-E1);
    C2 = g2*(Vm-E2);
    C = 480-C1-C2;
    dy = [m_t;n_t;h_t;C];
end